<!DOCTYPE html>


<head>
    <meta charset="utf-8">
    <title>Editar perfil</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="description" content="myHOME - real estate template project">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename = 'styles/profile.css') }}">
    <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename = 'styles/editprofile.css') }}">

    <!-- General links -->
    {% include 'include/headLinks.html' %}

</head>

<body>
<!-- Header -->
{% include 'include/header.html' %}

<!-- Title -->
<center>
    <div class="title_container">
        <div class="title">Editar Perfil</div>
    </div>
</center>
<div class="container">


    <div class="row">
        <div class="col-lg-4 text-center">
            <div class="mt-5">
                <!-- Begin Image -->
                <img class="portrait m-0 mb-3" src={{url_for('static',filename='profiles/pfp.png')}}
                     alt="{{ user.first_name }} {{ user.last_name }}"/>
                <!-- End Image -->
            </div>
            <form action="" method="POST">
                <input type="submit" id="image-change" class="mb-5 main_button" value="Cambiar imagen de perfil">
            </form>
        </div>

        <div class="col-lg-8">
            <h2 class="name">{{user.first_name}} {{user.last_name}}<br></h2>
            <hr>
            <div class="row">
                <div class="col-lg-6">
                    <div class="mt-3">
                        <div id="map" class="google_map_container text-center">
                        </div>
                        <form action="" method="POST">
                            {{ form_location.csrf_token }}
                            {{ form_location.lat(class="contact_input mb-2", id="lat") }}
                            {% for error in form_location.lat.errors %}
                                <div class="alert alert-danger">
                                    {{ error }}
                                </div>
                            {% endfor %}
                            {{ form_location.lng(class="contact_input mb-2", id="lng") }}
                            {% for error in form_location.lng.errors %}
                                <div class="alert alert-danger">
                                    {{ error }}
                                </div>
                            {% endfor %}
                            {{ form_location.submit(class="mb-5 main_button") }}
                        </form>
                        <script type="text/javascript">

                            if (navigator.geolocation) {
                                navigator.geolocation.getCurrentPosition(function(location){
                                    var lat = location.coords.latitude;
                                    var lng = location.coords.longitude;

                                    var base_url = "https://maps.googleapis.com/maps/api/staticmap"
                                    var markers = "?markers=" + lat + "," + lng
                                    var zoom = "&zoom=15"
                                    var size = "&size=400x300"
                                    var key = "&key={{ GOOGLEMAPS_KEY }}";

                                    document.getElementById("map").innerHTML = 
                                        "<img src='" + base_url + markers + zoom + size + key + "'>";
                                    document.getElementById("lat").value = lat;
                                    document.getElementById("lng").value = lng;
                                });
                            }
                        </script>
                    </div>
                </div>
                <div class="col-lg-6">
                    <!-- Begin Personal Information -->
                    <div class="mt-3">
                        <ul>
                            <form action="" method="POST">
                                {{ form_profile.csrf_token }}
                                <div class="mb-3">
                                    <strong>{{ form_profile.name.label }}:</strong>
                                    {{ form_profile.name(class="contact_input mb-2", value=user.first_name) }}
                                    {% for error in form_profile.name.errors %}
                                        <div class="alert alert-danger">
                                            {{ error }}
                                        </div>
                                    {% endfor %}
                                </div>
                                <div class="mb-3">
                                    <strong>{{ form_profile.lastname.label }}:</strong>
                                    {{ form_profile.lastname(class="contact_input mb-2", value=user.last_name) }}
                                    {% for error in form_profile.lastname.errors %}
                                        <div class="alert alert-danger">
                                            {{ error }}
                                        </div>
                                    {% endfor %}
                                </div>
                                <div class="mb-3">
                                    <strong>{{ form_profile.gender.label }}:</strong>
                                    {{ form_profile.gender() }}
                                    {% for error in form_profile.gender.errors %}
                                        <div class="alert alert-danger">
                                            {{ error }}
                                        </div>
                                    {% endfor %}
                                </div>

                                {{ form_profile.submit(class="mb-5 main_button") }}
                            </form>
                        </ul>
                    </div>
                    <!-- End Personal Information -->
                </div>
            </div>
            <div class="row">
                <div class="col-lg-6">
                    <div class="mt-3">
                        <form action="" method="POST">
                            {{ form_password.csrf_token }}
                            <div class="mb-3">
                                <strong>{{ form_password.password.label }}</strong><br>
                                {{ form_password.password(class="contact_input mb-2") }}
                                {% for error in form_password.password.errors %}
                                    <div class="alert alert-danger">
                                        {{ error }}
                                    </div>
                                {% endfor %}
                            </div>
                            <div class="mb-3">
                                <strong>{{ form_password.confirm.label }}</strong><br>
                                {{ form_password.confirm(class="contact_input mb-2") }}
                                {% for error in form_password.confirm.errors %}
                                    <div class="alert alert-danger">
                                        {{ error }}
                                    </div>
                                {% endfor %}
                            </div>
                            {{ form_password.submit(class="mb-5 main_button") }}
                        </form>
                    </div>
                </div>
                <div class="col-lg-6">
                    <div class="mt-3">
                        <form action="" method="POST">
                            {{ form_email.csrf_token }}
                            <div class="mb-3">
                                <strong>{{ form_email.email.label }}:</strong>
                                {{ form_email.email(class="contact_input mb-2", value=user.email) }}
                                {% for error in form_email.email.errors %}
                                    <div class="alert alert-danger">
                                        {{ error }}
                                    </div>
                                {% endfor %}
                            </div>
                            <div class="mb-3">
                                <strong>{{ form_email.confirm.label }}:</strong>
                                {{ form_email.confirm(class="contact_input mb-2", value=user.email) }}
                                {% for error in form_email.confirm.errors %}
                                    <div class="alert alert-danger">
                                        {{ error }}
                                    </div>
                                {% endfor %}
                            </div>
                            {{ form_email.submit(class="mb-5 main_button") }}
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<!-- Footer  -->
{% include 'include/footer.html' %}


<!-- General Scripts  -->
{% include 'include/scripts.html' %}
</body>
